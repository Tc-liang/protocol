syntax = "proto3";
package openim.user;

import "conversation/conversation.proto";
import "sdkws/sdkws.proto";
import "wrapperspb/wrapperspb.proto";

option go_package = "github.com/openimsdk/protocol/user";

option java_multiple_files = true;
option java_package = "city.cn.im.proto.user";
option java_outer_classname = "IMUserServiceOuterClass";


message GetAllUserIDReq {
  sdkws.RequestPagination pagination = 1;
}
message GetAllUserIDResp {
  int32 total = 1;
  repeated string userIDs = 2;
}

message AccountCheckReq {
  repeated string checkUserIDs = 1;
}
message AccountCheckResp {
  message SingleUserStatus {
    string userID = 1;
    int32 accountStatus = 2;
  }
  repeated SingleUserStatus results = 1;
}

message GetDesignateUsersReq {
  repeated string userIDs = 1;
}
message GetDesignateUsersResp {
  repeated sdkws.UserInfo usersInfo = 1;
}

message UpdateUserInfoReq {
  sdkws.UserInfo userInfo = 1;
}
message UpdateUserInfoResp {}

message UpdateUserInfoExReq {
  sdkws.UserInfoWithEx userInfo = 1;
}
message UpdateUserInfoExResp {}

message SetGlobalRecvMessageOptReq {
  string userID = 1;
  int32 globalRecvMsgOpt = 3;
}
message SetGlobalRecvMessageOptResp {}

message SetConversationReq {
  openim.conversation.Conversation conversation = 1;
  int32 notificationType = 2;
  string operationID = 3;
}
message SetConversationResp {}

message SetRecvMsgOptReq {
  string ownerUserID = 1;
  string conversationID = 2;
  int32 recvMsgOpt = 3;
  int32 notificationType = 4;
  string operationID = 5;
}
message SetRecvMsgOptResp {}

message GetConversationReq {
  string conversationID = 1;
  string ownerUserID = 2;
  string operationID = 3;
}
message GetConversationResp {
  openim.conversation.Conversation conversation = 2;
}

message GetConversationsReq {
  string ownerUserID = 1;
  repeated string conversationIDs = 2;
  string operationID = 3;
}
message GetConversationsResp {
  repeated openim.conversation.Conversation conversations = 2;
}

message GetAllConversationsReq {
  string ownerUserID = 1;
  string operationID = 2;
}
message GetAllConversationsResp {
  repeated openim.conversation.Conversation conversations = 2;
}

message BatchSetConversationsReq {
  repeated openim.conversation.Conversation conversations = 1;
  string OwnerUserID = 2;
  int32 notificationType = 3;
  string OperationID = 4;
}
message BatchSetConversationsResp {
  repeated string Success = 2;
  repeated string Failed = 3;
}

message GetPaginationUsersReq {
  sdkws.RequestPagination pagination = 2;
  string userID = 3;
  string nickName = 4;
}
message GetPaginationUsersResp {
  int32 total = 1;
  repeated sdkws.UserInfo users = 2;
}

message UserRegisterReq {
  repeated sdkws.UserInfo users = 1;
}
message UserRegisterResp {}

message GetGlobalRecvMessageOptReq {
  string userID = 1;
}
message GetGlobalRecvMessageOptResp {
  int32 globalRecvMsgOpt = 1;
}

message UserRegisterCountReq {
  int64 start = 1;
  int64 end = 2;
}
message UserRegisterCountResp {
  int64 total = 1;
  int64 before = 2;
  map<string, int64> count = 3;
}

message SubscribeOrCancelUsersStatusReq {
  string userID = 1;
  repeated string userIDs = 2;
  int32 genre = 3;
}
message SubscribeOrCancelUsersStatusResp {
  repeated OnlineStatus statusList = 1;
}

message GetSubscribeUsersStatusReq {
  string userID = 1;
}
message GetSubscribeUsersStatusResp {
  repeated OnlineStatus statusList = 1;
}

message OnlineStatus {
  string userID = 1;
  int32 status = 2;
  repeated int32 platformIDs = 3;
}

message GetUserStatusReq {
  string userID = 1;
  repeated string userIDs = 2;
}
message GetUserStatusResp {
  repeated OnlineStatus statusList = 1;
}

message SetUserStatusReq {
  string userID = 1;
  int32 status = 2;
  int32 platformID = 3;
  string connID = 4;
  bool isBackground = 5;
}
message SetUserStatusResp {}

message UserOnlineStatus {
  string userID = 1;
  string connID = 2;
  repeated int32 online = 3;
  repeated int32 offline = 4;
}

message SetUserOnlineStatusReq {
  repeated UserOnlineStatus status = 1;
}
message SetUserOnlineStatusResp {}

message ProcessUserCommandAddReq {
  string userID = 1;
  int32 type = 2;
  string uuid = 3;
  openim.protobuf.StringValue value = 4;
  openim.protobuf.StringValue ex = 5;
}
message ProcessUserCommandAddResp {}

message ProcessUserCommandDeleteReq {
  string userID = 1;
  int32 type = 2;
  string uuid = 3;
}
message ProcessUserCommandDeleteResp {}

message ProcessUserCommandUpdateReq {
  string userID = 1;
  int32 type = 2;
  string uuid = 3;
  openim.protobuf.StringValue value = 4;
  openim.protobuf.StringValue ex = 5;
}
message ProcessUserCommandUpdateResp {}

message ProcessUserCommandGetReq {
  string userID = 1;
  int32 type = 2;
}

message CommandInfoResp {
  int32 type = 1;
  int64 createTime = 2;
  string uuid = 3;
  string value = 4;
  string ex = 5;
}

message ProcessUserCommandGetResp {
  repeated CommandInfoResp CommandResp = 1;
}

message ProcessUserCommandGetAllReq {
  string userID = 1;
}
message AllCommandInfoResp {
  int32 type = 1;
  int64 createTime = 2;
  string uuid = 3;
  string value = 4;
  string ex = 5;
}
message ProcessUserCommandGetAllResp {
  repeated AllCommandInfoResp CommandResp = 1;
}

message AddNotificationAccountReq {
  string userID = 1;
  string nickName = 2;
  string faceURL = 3;
  int32 appMangerLevel = 4;
}
message AddNotificationAccountResp {
  string userID = 1;
  string faceURL = 2;
  string nickName = 3;
  int32 appMangerLevel = 4;
}

message UpdateNotificationAccountInfoReq {
  string userID = 1;
  string faceURL = 2;
  string nickName = 3;
}
message UpdateNotificationAccountInfoResp {}

message SearchNotificationAccountReq {
  string keyword = 1;
  optional int32 appManagerLevel = 2;
  sdkws.RequestPagination pagination = 3;
}

message NotificationAccountInfo {
  string userID = 1;
  string faceURL = 2;
  string nickName = 3;
  int32 appMangerLevel = 4;
}

message SearchNotificationAccountResp {
  int64 total = 1;
  repeated NotificationAccountInfo notificationAccounts = 2;
}

message GetNotificationAccountReq {
  string userID = 1;
}
message GetNotificationAccountResp {
  NotificationAccountInfo account = 1;
}

message SortQueryReq {
  bool asc = 1;
  map<string, string> userIDName = 2;
}
message SortQueryResp {
  repeated sdkws.UserInfo users = 2;
}

message GetAllOnlineUsersReq {
  uint64 cursor = 1;
}
message GetAllOnlineUsersResp {
  repeated OnlineStatus StatusList = 1;
  uint64 nextCursor = 2;
}

message GetUserClientConfigReq {
  string userID = 1;
}
message GetUserClientConfigResp {
  map<string,string> configs = 2;
}

message SetUserClientConfigReq {
  string userID = 1;
  map<string,string> configs = 2;
}
message SetUserClientConfigResp {}

message DelUserClientConfigReq {
  string userID = 1;
  repeated string keys = 2;
}
message DelUserClientConfigResp {}

message PageUserClientConfigReq {
  string userID = 1;
  string key = 2;
  sdkws.RequestPagination pagination = 3;
}
message PageUserClientConfigResp {
  int64 total = 1;
  repeated ClientConfig configs = 2;
}

message ClientConfig {
  string key = 1;
  string userID = 2;
  string value = 3;
}

message GetBotUserReq {
  repeated string userIDs = 1;
}
message GetBotUserResp {
  repeated string userIDs = 1;
}

service User {
  rpc GetDesignateUsers(GetDesignateUsersReq) returns (GetDesignateUsersResp);
  rpc UpdateUserInfo(UpdateUserInfoReq) returns (UpdateUserInfoResp);
  rpc UpdateUserInfoEx(UpdateUserInfoExReq) returns (UpdateUserInfoExResp);
  rpc SetGlobalRecvMessageOpt(SetGlobalRecvMessageOptReq) returns (SetGlobalRecvMessageOptResp);
  rpc GetGlobalRecvMessageOpt(GetGlobalRecvMessageOptReq) returns (GetGlobalRecvMessageOptResp);
  rpc AccountCheck(AccountCheckReq) returns (AccountCheckResp);
  rpc GetPaginationUsers(GetPaginationUsersReq) returns (GetPaginationUsersResp);
  rpc UserRegister(UserRegisterReq) returns (UserRegisterResp);
  rpc GetAllUserID(GetAllUserIDReq) returns (GetAllUserIDResp);
  rpc UserRegisterCount(UserRegisterCountReq) returns (UserRegisterCountResp);
  rpc SubscribeOrCancelUsersStatus(SubscribeOrCancelUsersStatusReq) returns (SubscribeOrCancelUsersStatusResp);
  rpc GetSubscribeUsersStatus(GetSubscribeUsersStatusReq) returns (GetSubscribeUsersStatusResp);
  rpc GetUserStatus(GetUserStatusReq) returns (GetUserStatusResp);
  rpc SetUserStatus(SetUserStatusReq) returns (SetUserStatusResp);
  rpc ProcessUserCommandAdd(ProcessUserCommandAddReq) returns (ProcessUserCommandAddResp);
  rpc ProcessUserCommandUpdate(ProcessUserCommandUpdateReq) returns (ProcessUserCommandUpdateResp);
  rpc ProcessUserCommandDelete(ProcessUserCommandDeleteReq) returns (ProcessUserCommandDeleteResp);
  rpc ProcessUserCommandGet(ProcessUserCommandGetReq) returns (ProcessUserCommandGetResp);
  rpc ProcessUserCommandGetAll(ProcessUserCommandGetAllReq) returns (ProcessUserCommandGetAllResp);
  rpc AddNotificationAccount(AddNotificationAccountReq) returns (AddNotificationAccountResp);
  rpc UpdateNotificationAccountInfo(UpdateNotificationAccountInfoReq) returns (UpdateNotificationAccountInfoResp);
  rpc SearchNotificationAccount(SearchNotificationAccountReq) returns (SearchNotificationAccountResp);
  rpc GetNotificationAccount(GetNotificationAccountReq) returns (GetNotificationAccountResp);
  rpc SortQuery(SortQueryReq) returns (SortQueryResp);
  rpc SetUserOnlineStatus(SetUserOnlineStatusReq) returns (SetUserOnlineStatusResp);
  rpc GetAllOnlineUsers(GetAllOnlineUsersReq) returns (GetAllOnlineUsersResp);
  rpc GetUserClientConfig(GetUserClientConfigReq) returns (GetUserClientConfigResp);
  rpc SetUserClientConfig(SetUserClientConfigReq) returns (SetUserClientConfigResp);
  rpc DelUserClientConfig(DelUserClientConfigReq) returns (DelUserClientConfigResp);
  rpc PageUserClientConfig(PageUserClientConfigReq) returns (PageUserClientConfigResp);
  rpc GetBotUser(GetBotUserReq) returns (GetBotUserResp);
}
